const { webcrypto } = require('crypto');

class CryptoMock {
  constructor() {
    this._impl = webcrypto;
    this.subtle = webcrypto.subtle;
  }

  getRandomValues(array) {
    return this._impl.getRandomValues(array);
  }

  randomUUID() {
    if (typeof this._impl.randomUUID === 'function') {
      return this._impl.randomUUID();
    }
    throw new Error('randomUUID is not supported by the underlying implementation.');
  }
}

module.exports = { Crypto: CryptoMock };
